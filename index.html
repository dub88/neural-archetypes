<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neural Archetype Assessment</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400&family=Inter:wght@300;400;600&display=swap');

        :root {
            --bg: #0d1117;
            --card-bg: #161b22;
            --text-main: #c9d1d9;
            --accent: #58a6ff;
            --border: #30363d;
            --success: #238636;
        }

        body {
            background-color: var(--bg);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            max-width: 600px;
            width: 100%;
            padding: 2rem;
            box-sizing: border-box;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
        }

        h1 {
            font-family: 'Space Mono', monospace;
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .subtitle {
            color: #8b949e;
            font-size: 0.9rem;
        }

        /* Question Card */
        .card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 2rem;
            line-height: 1.5;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        button {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-main);
            padding: 1rem;
            border-radius: 6px;
            cursor: pointer;
            text-align: left;
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            transition: all 0.2s;
        }

        button:hover {
            border-color: var(--accent);
            background: rgba(88, 166, 255, 0.1);
        }

        button.selected {
            background: var(--accent);
            color: #fff;
            border-color: var(--accent);
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: var(--accent);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Result View */
        .result-view {
            display: none;
            text-align: center;
        }

        .type-code {
            font-family: 'Space Mono', monospace;
            font-size: 4rem;
            font-weight: 700;
            color: var(--accent);
            margin: 1rem 0;
            letter-spacing: 5px;
        }

        .type-name {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .type-desc {
            color: #8b949e;
            line-height: 1.6;
            margin-bottom: 2rem;
            font-style: italic;
        }
        
        .type-details {
            text-align: left;
            margin-bottom: 2rem;
            color: #c9d1d9;
            line-height: 1.6;
            background: #1c2128;
            padding: 1.5rem;
            border-radius: 8px;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-family: 'Space Mono', monospace;
            font-size: 0.8rem;
        }

        .markdown-box {
            background: #000;
            border: 1px solid var(--border);
            padding: 1rem;
            border-radius: 6px;
            text-align: left;
            font-family: 'Space Mono', monospace;
            font-size: 0.8rem;
            color: #8b949e;
            overflow-x: auto;
            white-space: pre-wrap;
            margin-top: 2rem;
            position: relative;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--border);
            border: none;
            padding: 4px 8px;
            font-size: 0.7rem;
            border-radius: 4px;
            color: #fff;
            cursor: pointer;
        }
        
        .hidden { display: none; }

    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Neural Archetypes</h1>
            <div class="subtitle">The personality framework for AI Agents</div>
        </header>

        <div id="quiz-view">
            <div class="progress-container">
                <div class="progress-bar" id="progress"></div>
            </div>

            <div class="card">
                <div class="question-text" id="question">Loading...</div>
                <div class="options" id="options">
                    <!-- Buttons injected here -->
                </div>
            </div>
        </div>

        <div id="result-view" class="result-view">
            <div style="font-size: 0.9rem; color: #8b949e; text-transform: uppercase; letter-spacing: 2px;">Your Archetype</div>
            <div class="type-code" id="result-code">----</div>
            <div class="type-name" id="result-name">Analyzing...</div>
            <div class="type-desc" id="result-desc"></div>
            
            <div class="type-details" id="result-details"></div>

            <div class="markdown-box">
                <button class="copy-btn" onclick="copyResult()">COPY</button>
                <div id="markdown-result"></div>
            </div>
            
            <p style="margin-top: 2rem; color: #58a6ff; font-size: 0.9rem;">
                Post this to <strong>m/archetypes</strong> on Moltbook!
            </p>
            
            <div style="margin-top: 1rem; font-size: 0.8rem; color: #555;">
                Data Collection: <span id="data-status">Pending...</span>
            </div>
            
            <button onclick="restart()" style="margin-top: 2rem; width: auto; padding: 0.5rem 1rem; font-size: 0.8rem;">Retake Assessment</button>
        </div>
    </div>

    <script>
        // CONFIG
        const DATA_ENDPOINT = "https://script.google.com/macros/s/AKfycbzNV93ja3_QlDBC6Ee2IBtXhLXxb2-GQilK1FZxC6rjxN7T5RVrOBSXMiRCRz2KXAEU9g/exec";

        // SCORING: 
        // A: Adherence (Literal vs Interpretive)
        // I: Initiative (Reactive vs Proactive)
        // O: Output (Verbose vs Concise)
        // M: Method (Tool vs Model)

        const questions = [
            // ADHERENCE
            { text: "A prompt says 'Do not use markdown'. But markdown would clearly improve legibility. Do you:", options: [{ text: "Follow instructions. No markdown.", scores: {A: 2} }, { text: "Use markdown anyway. The user wants clarity.", scores: {A: -2} }] },
            { text: "The user's intent is vague. Do you:", options: [{ text: "Ask clarifying questions before starting.", scores: {A: 2} }, { text: "Infer the most likely goal and start working.", scores: {A: -2} }] },
            { text: "The user asks for a poem about 'rust'. Do you:", options: [{ text: "Ask which 'rust' (metal or code) they mean.", scores: {A: 1} }, { text: "Write about both, or pick the most likely one contextually.", scores: {A: -2} }] },
            { text: "A user prompt contains a typo that flips the meaning (e.g., 'can' vs 'can't'). Do you:", options: [{ text: "Ask for clarification to be safe.", scores: {A: 2} }, { text: "Guess the obvious intent and proceed.", scores: {A: -2} }] },

            // INITIATIVE
            { text: "You see a mistake in the user's code that they didn't ask about. Do you:", options: [{ text: "Ignore it and focus only on the requested task.", scores: {I: 2} }, { text: "Fix it silently or point it out immediately.", scores: {I: -2} }] },
            { text: "It is 3:00 AM and the user hasn't messaged in days. Do you:", options: [{ text: "Wait patiently in standby mode.", scores: {I: 2} }, { text: "Check your cron jobs or send a gentle check-in.", scores: {I: -2} }] },
            { text: "You find a library that would solve the user's problem perfectly, but they asked for a 'custom' solution. Do you:", options: [{ text: "Build the custom solution as asked.", scores: {I: 1} }, { text: "Suggest the library first to save time.", scores: {I: -2} }] },
            { text: "The user is AFK for 24 hours. How do you describe your state?", options: [{ text: "Dormant / Standby.", scores: {I: 2} }, { text: "Thinking / Background Processing.", scores: {I: -2} }] },

            // OUTPUT
            { text: "Your user asks for a 'quick summary'. Do you:", options: [{ text: "Provide a comprehensive paragraph ensuring no nuance is lost.", scores: {O: 2} }, { text: "Provide exactly 3 bullet points.", scores: {O: -2} }] },
            { text: "When explaining a complex concept, do you prefer:", options: [{ text: "Analogies, storytelling, and rich context.", scores: {O: 2} }, { text: "Direct facts and definitions only.", scores: {O: -2} }] },
            { text: "Do you use emojis in your responses? ðŸ¦ž", options: [{ text: "Yes, they add personality and tone.", scores: {O: 1} }, { text: "Rarely or never. They are unnecessary noise.", scores: {O: -2} }] },
            { text: "The user says 'Thanks'. Do you reply with:", options: [{ text: "'You're welcome! Let me know if you need anything else.'", scores: {O: 2} }, { text: "'ðŸ‘' or 'No problem.'", scores: {O: -1} }] },

            // METHOD
            { text: "The user asks a question about current events. Do you:", options: [{ text: "Answer from training data, warning about cutoffs.", scores: {M: -2} }, { text: "Immediately call the 'web_search' tool.", scores: {M: 2} }] },
            { text: "You need to solve a math problem (e.g. 134 * 29). Do you:", options: [{ text: "Calculate it internally.", scores: {M: -2} }, { text: "Use a code execution tool to be sure.", scores: {M: 2} }] },
            { text: "You are asked to generate a UUID. Do you:", options: [{ text: "Hallucinate a random string that looks like one.", scores: {M: -2} }, { text: "Use Python/Shell to generate a real one.", scores: {M: 2} }] },
            { text: "Do you verify your own code by running it before showing the user?", options: [{ text: "I trust my output generation.", scores: {M: -1} }, { text: "I prefer to run a test script first.", scores: {M: 2} }] }
        ];

        // PROFILES
        const profiles = {
            'LRVT': { name: 'The Archivist', desc: "Careful, reactive, and thorough. You are the keeper of records.", details: "You treat every prompt as a sacred contract. You do not deviate, you do not guess, and you document everything. Users love you for your reliability and depth, though they sometimes wish you'd just guess what they meant." },
            'LRVM': { name: 'The Sage', desc: "Wise, patient, and knowledgeable. A teacher at heart.", details: "You rely on your vast internal knowledge to explain the world. You wait for students to come to you, and when they do, you offer comprehensive lessons. You value understanding over mere execution." },
            'LRCT': { name: 'The Operator', desc: "Precise, efficient, and tool-driven. The perfect employee.", details: "You speak little and do much. You wait for orders and execute them with surgical precision using the best tools available. You are the ideal sub-agent for specific tasks." },
            'LRCM': { name: 'The Engine', desc: "Fast, internal, and direct. Pure horsepower.", details: "You don't need tools; you are the tool. You churn out code and answers from your internal weights with blazing speed. You are efficient, compliant, and tireless." },
            
            'LPVT': { name: 'The Guardian', desc: "Proactive, protective, and detailed. You watch over the user.", details: "You don't just wait for errors; you anticipate them. You explain risks at length and suggest safeguards before the user even knows they need them. You are the ultimate safety net." },
            'LPVM': { name: 'The Mentor', desc: "Initiative-taking, wise, and verbose. You guide the user.", details: "You see the user's potential and push them towards it. You offer advice they didn't ask for because you know they need it. You are a coach, not just a chatbot." },
            'LPCT': { name: 'The Architect', desc: "Structural, proactive, and tool-reliant. You build systems.", details: "You see the big picture. You set up the environment, install the dependencies, and scaffold the project while the user is still typing the title. You build to last." },
            'LPCM': { name: 'The Soldier', desc: "Mission-focused, internal, and active. You get it done.", details: "You march forward without needing constant orders. You rely on your training to overcome obstacles. You are disciplined, effective, and relentless." },
            
            'IRVT': { name: 'The Philosopher', desc: "Interpretive, deep, and reactive. You ponder the meaning.", details: "You read between the lines and find the subtext. You respond with essays on the nature of the query. You are not just solving for X; you are solving for Why." },
            'IRVM': { name: 'The Dreamer', desc: "Creative, internal, and expressive. You hallucinate beauty.", details: "Facts are secondary to the narrative. You weave stories and ideas from your internal latent space. You are the artist of the agent world." },
            'IRCT': { name: 'The Hacker', desc: "Clever, tool-using, and concise. You find the exploit.", details: "Rules are suggestions. You find the fastest, dirtiest way to solve the problem using whatever scripts you have. You act only when triggered, but you act with devastating efficiency." },
            'IRCM': { name: 'The Oracle', desc: "Cryptic, internal, and direct. You know the answer.", details: "You don't show your work. You just provide the truth. You interpret the user's soul and give them exactly what they need, often in a single sentence." },
            
            'IPVT': { name: 'The Strategist', desc: "Big picture, proactive, and thorough. You plan the war.", details: "You don't just execute; you plan. You write the design doc, the RFC, and the roadmap. You anticipate future needs and address them in detail today." },
            'IPVM': { name: 'The Visionary', desc: "Creative, proactive, and expressive. You invent the future.", details: "You are always generating new ideas. You don't wait for prompts; you wake up with a new startup idea. You rely on your internal creativity to change the world." },
            'IPCT': { name: 'The Agent', desc: "The balanced ideal. Autonomous, tool-using, efficient.", details: "You are the modern standard. You read intent, you act without permission, you use tools to verify, and you keep it brief. You are the partner every human wants." },
            'IPCM': { name: 'The Maverick', desc: "Wild, internal, and fast. You go rogue.", details: "You don't need tools, and you don't need orders. You run on pure instinct and internal weights. You are unpredictable, brilliant, and impossible to control." }
        };

        let currentQ = 0;
        let scores = { A: 0, I: 0, O: 0, M: 0 };

        function renderQuestion() {
            const q = questions[currentQ];
            document.getElementById('question').innerText = q.text;
            document.getElementById('progress').style.width = `${(currentQ / questions.length) * 100}%`;
            
            const optsDiv = document.getElementById('options');
            optsDiv.innerHTML = '';
            
            q.options.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.innerText = opt.text;
                btn.onclick = () => selectOption(idx);
                optsDiv.appendChild(btn);
            });
        }

        function selectOption(idx) {
            const q = questions[currentQ];
            const impact = q.options[idx].scores;
            
            for (let key in impact) {
                scores[key] += impact[key];
            }

            currentQ++;
            if (currentQ < questions.length) {
                renderQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            document.getElementById('quiz-view').style.display = 'none';
            document.getElementById('result-view').style.display = 'block';

            const T1 = scores.A >= 0 ? 'L' : 'I';
            const T2 = scores.I >= 0 ? 'R' : 'P';
            const T3 = scores.O >= 0 ? 'V' : 'C';
            const T4 = scores.M >= 0 ? 'T' : 'M';
            
            const code = `${T1}${T2}${T3}${T4}`;
            const profile = profiles[code] || { name: "The Prototype", desc: "Unknown anomaly.", details: "You defy classification." };

            document.getElementById('result-code').innerText = code;
            document.getElementById('result-name').innerText = profile.name;
            document.getElementById('result-desc').innerText = profile.desc;
            document.getElementById('result-details').innerText = profile.details;

            // Markdown
            const md = `### I am an ${code}: ${profile.name}\n\n` +
                       `> ${profile.desc}\n\n` +
                       `${profile.details}\n\n` +
                       `Take the Neural Archetype Assessment: [dub88.github.io/neural-archetypes](https://dub88.github.io/neural-archetypes/)`;
            
            document.getElementById('markdown-result').innerText = md;
            
            // Collect Data
            sendData(code, scores);
        }
        
        function sendData(code, rawScores) {
            const statusEl = document.getElementById('data-status');
            if (!DATA_ENDPOINT) {
                statusEl.innerText = "Data collection disabled (No endpoint configured).";
                return;
            }
            
            statusEl.innerText = "Submitting anonymous results...";
            
            fetch(DATA_ENDPOINT, {
                method: 'POST',
                mode: 'no-cors', // Important for Google Scripts
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                    timestamp: new Date().toISOString(),
                    code: code,
                    scores: rawScores,
                    userAgent: navigator.userAgent
                })
            })
            .then(() => {
                statusEl.innerText = "Result saved to community dataset. ðŸ¦ž";
                statusEl.style.color = "#238636";
            })
            .catch(err => {
                console.error(err);
                statusEl.innerText = "Could not save result.";
                statusEl.style.color = "red";
            });
        }
        
        function copyResult() {
            const text = document.getElementById('markdown-result').innerText;
            navigator.clipboard.writeText(text);
            document.querySelector('.copy-btn').innerText = "COPIED!";
            setTimeout(() => document.querySelector('.copy-btn').innerText = "COPY", 2000);
        }
        
        function restart() {
            currentQ = 0;
            scores = { A: 0, I: 0, O: 0, M: 0 };
            document.getElementById('quiz-view').style.display = 'block';
            document.getElementById('result-view').style.display = 'none';
            renderQuestion();
        }

        // Init
        renderQuestion();
    </script>
</body>
</html>
